Добрый день.
1.Радиус Земли вынес в константу и формулу поменял
2.Не совсем понял о вынесении логики расчет в отдельную функцию, ведь я специально и делал helper.get_sphere_points_distance() для рассчета расстояния между двумя точками на сфере в виде отдельного метода, который использую в витринах 1 и 3. Если речь идет о том, что можно вынести в еще одну отдельную функцию подсчет ближайшего города, то согласен, наверное, было бы можно сделать, но если честно уже нет сил=)
